@using OpenQA.Selenium;
@using OpenQA.Selenium.Chrome;
@using System.Threading;


<h2>Nutrition</h2>

@{var productName = ViewBag.Title;}

@{IWebDriver driver = new ChromeDriver();}

@{driver.Navigate().GoToUrl("https://fdc.nal.usda.gov/");}

@{IWebElement element = driver.FindElement(By.Name("query"));}

@{element.SendKeys(productName);}

@{element.SendKeys(Keys.Enter);}

<br>

@{var ResultProductName = "The product you searched for is: " + productName;}

<p>@ResultProductName</p>

@{Thread.Sleep(2000);}

@{var ProductMatchName = driver.FindElement(By.Name("food-search-result-description"));}

@{var ResultProductMatchName = "The closest product match found is: " + ProductMatchName.Text;}
<p>@ResultProductMatchName</p>

<br>

@{var click = driver.FindElement(By.Name("food-search-result-description"));}
@{click.Click();}

@{var LiquidProduct = "A Serving size is equal to 100ml for liquid products.";}
<p>@LiquidProduct</p>

@{var SolidProduct = "A Serving size is equal to 100g for solid products.";}
<p>@SolidProduct</p>

<br>

@try
{

    Thread.Sleep(2000);
    var locateNutritionVal = driver.FindElements(By.XPath("//*[@id='nutrients-table']/tbody/tr"));

        foreach (var NutritionVal in locateNutritionVal)
        {
            <p>@NutritionVal.Text</p>
        }
}
catch (NoSuchElementException)
{

    var NoNutritionVal = "Sorry, Could not find information on nutritional value.";
    <p>@NoNutritionVal</p>
}

<br>

@try
{

    Thread.Sleep(1000);
    var Ingredients = driver.FindElement(By.XPath("//*[@id='nutrients']/app-food-nutrients/div/div[2]/div"));
    <p>@Ingredients.Text</p>
}
catch (NoSuchElementException)
{

    var NoIngredients = "Sorry, ingredients are not available for this product.";
    <p>@NoIngredients</p>
}



@* Need to add better style + try catch for error handling *@